FROM registry.svc.ci.openshift.org/openshift/release:golang-1.13

ENV OPERATOR_SDK_VERSION=v0.12.0 \
    GOFLAGS=""

# install operator-sdk (from git with no history and only the tag)
RUN mkdir -p $GOPATH/src/github.com/operator-framework \
    && cd $GOPATH/src/github.com/operator-framework \
    && git clone --depth 1 -b $OPERATOR_SDK_VERSION https://github.com/operator-framework/operator-sdk \
    && cd operator-sdk \
    && go mod vendor \
    && make tidy \
    && make install \
    && chmod -R 0777 $GOPATH \
    && rm -rf $GOPATH/.cache

# install jq
RUN wget -O jq https://github.com/stedolan/jq/releases/download/jq-1.6/jq-linux64 \
    && chmod +x ./jq \
    && cp jq /usr/bin

# install yq
RUN wget -O yq https://github.com/mikefarah/yq/releases/download/3.1.1/yq_linux_amd64 \
    && chmod +x ./yq \
    && cp yq /usr/bin
